import{y as j,z as B,r as _,T as L,o as r,c as l,b as t,e as R,v as H,u as a,n as h,t as g,d as C,K as S,O as y,l as T,g as u,A as x,B as N,F as P,C as D,i as F,p as U,a as A}from"./app-a15ffb42.js";const b=j("posts",()=>{const c=new URL(window.location.href).searchParams,s=Number(c.get("page"))?Number(c.get("page")):1,n=B({data:[]}),p=_(!1),k=_(s),i=_(1),d=_(null),o=v=>{n.data=v},f=v=>{n.data=n.data.map(m=>(m.id===v&&(m.isLiked=!0,m.likesCount+=1),m))},w=v=>{n.data=n.data.map(m=>(m.id===v&&(m.isLiked=!1,m.likesCount-=1),m))},z=()=>{p.value=!0},M=v=>{d.value=v};return{posts:n,currentPage:k,lastPage:i,showPostModal:p,setPostToReply:M,postToReply:d,openPostModal:z,closePostModal:()=>{d.value&&M(null),p.value=!1},openReplyModal:v=>{M(v),p.value=!0},setPosts:o,setLiked:f,setUnliked:w,setCurrentPage:v=>{k.value=v},setLastPage:v=>{i.value=v}}}),V=["onSubmit"],E={class:"mb-2"},O={class:"text-error"},I=t("div",{class:"form-control"},[t("button",{class:"btn btn-sm btn-primary w-full",type:"submit"},"Publish")],-1),W={__name:"PostForm",emits:["post-created"],setup(e,{emit:c}){const s=L({content:""}),n=b(),p=async()=>{if(n.postToReply){s.post(route("posts.reply",{post:n.postToReply.id}),{preserveState:!1,onSuccess:()=>{s.reset(),c("post-created")}});return}s.post(route("posts.store"),{onSuccess:()=>{s.reset(),c("post-created")}})};return(k,i)=>(r(),l("form",{class:"py-3",onSubmit:C(p,["prevent"])},[t("div",E,[R(t("textarea",{name:"content",onInput:i[0]||(i[0]=d=>a(s).errors.content=null),"onUpdate:modelValue":i[1]||(i[1]=d=>a(s).content=d),placeholder:"What's happen?",class:h([{"textarea-error":a(s).content.length>255||a(s).errors.content},"textarea textarea-bordered resize-none textarea-sm w-full"])},null,34),[[H,a(s).content]]),t("p",O,g(a(s).errors.content),1),t("span",{class:h(["text-gray-500 text-xs",{"text-red-500":a(s).content.length>255}])},g(a(s).content.length)+" / 255",3)]),I],40,V))}},$={loadMorePosts(){const e=b();if(e.currentPage>=e.lastPage)return;const c=e.currentPage+1,s=S(),n=new URL(window.location.href),p=n.searchParams;p.set("page",c),n.search=p.toString(),y.get(n.toString(),{},{preserveState:!0,preserveScroll:!0,only:["posts"],onSuccess:({props:k})=>{var o;const i=e.posts.data,d=((o=k.posts)==null?void 0:o.data)??k.replies.data;e.setPosts([...i,...d]),e.setCurrentPage(c),window.history.replaceState({},s.title,n.toString())}})},deletePost(e){y.delete(route("posts.delete",{post:e}))},like(e){const c=b();y.post(route("posts.like",{post:e}),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{c.setLiked(e)}})},unlike(e){const c=b();y.delete(route("posts.unlike",{post:e}),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{c.setUnliked(e)}})},listenDeletingPost(){const e=b();Echo.channel("feed").listen("PostDeleted",c=>{const s=e.posts.data;e.setPosts(s.filter(n=>n.id!==c.id))})},listenCreatingPost(){const e=b();Echo.channel("feed").listen("PostCreated",({post:c})=>{e.setPosts([c,...e.posts.data])})}},q={class:"border border-neutral-focus rounded p-3"},K={class:"card-header mb-3 flex justify-between"},G={class:"author items-center flex gap-5"},J={key:0,class:"avatar"},Q={class:"w-12 rounded-full"},X=["href"],Y=["src"],Z={key:1,class:"avatar placeholder"},tt={class:"bg-neutral-focus text-neutral-content w-12 rounded-full"},et={class:"text-2xl font-bold"},ot={class:"author-text"},st={class:"font-bold"},nt=["href"],rt={class:"font-mono text-gray-500 text-sm"},lt=["href"],at={class:"font-mono text-gray-500 text-sm"},it=x('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 7h16"></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path><path d="M10 12l4 4m0 -4l-4 4"></path></svg>',1),ct=[it],dt={class:"break-words text-lg"},ht={key:0,class:"actions mt-2 flex items-center gap-2 justify-start"},ut={class:"likes flex gap-1"},pt={key:0,class:"font-bold text-lg"},ft=t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),wt=t("path",{d:"M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572"},null,-1),vt=[ft,wt],kt=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-message-circle-2",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M3 20l1.3 -3.9a9 8 0 1 1 3.4 2.9l-4.7 1"})],-1),gt=[kt],mt=["href"],bt=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-message-circle-2",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M3 20l1.3 -3.9a9 8 0 1 1 3.4 2.9l-4.7 1"})],-1),_t=[bt],yt={key:1},xt=["href"],Mt={__name:"Post",props:{post:{type:Object,default:null},withoutActions:{type:Boolean,default:!1}},setup(e){const{withoutActions:c,post:s}=e,n=b(),p=S(),k=T(()=>{var i,d;return((d=(i=p.props.auth)==null?void 0:i.user)==null?void 0:d.nickname)===s.author.nickname&&!c});return(i,d)=>(r(),l("article",q,[t("div",K,[t("div",G,[e.post.author.avatar?(r(),l("div",J,[t("div",Q,[t("a",{href:i.route("profile.show",{user:e.post.author.nickname})},[t("img",{src:e.post.author.avatar,alt:"post.author.name"},null,8,Y)],8,X)])])):(r(),l("div",Z,[t("div",tt,[t("span",et,g(e.post.author.name),1)])])),t("div",ot,[t("h6",st,[t("a",{href:i.route("profile.show",{user:e.post.author.nickname})},g(e.post.author.name),9,nt)]),t("p",rt,[t("a",{href:i.route("profile.show",{user:e.post.author.nickname})}," @"+g(e.post.author.nickname),9,lt)]),t("p",at,g(e.post.created),1)])]),k.value?(r(),l("button",{key:0,onClick:d[0]||(d[0]=o=>a($).deletePost(e.post.id))},ct)):u("",!0)]),t("p",dt,g(e.post.content),1),e.withoutActions?u("",!0):(r(),l("div",ht,[t("div",ut,[e.post.likesCount?(r(),l("p",pt,g(e.post.likesCount),1)):u("",!0),i.$page.props.auth.user?(r(),l("button",{key:1,onClick:d[1]||(d[1]=o=>e.post.isLiked?a($).unlike(e.post.id):a($).like(e.post.id))},[(r(),l("svg",{class:h([{"fill-pink-300 stroke-pink-500":e.post.isLiked},"icon icon-tabler icon-tabler-heart"]),xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},vt,2))])):u("",!0)]),i.$page.props.auth.user?(r(),l("button",{key:0,class:"hidden md:block",onClick:d[2]||(d[2]=C(o=>a(n).openReplyModal(e.post),["stop"]))},gt)):u("",!0),t("a",{class:"md:hidden",href:i.route("posts.reply.create",{post:e.post.id})},_t,8,mt),e.post.repliesCount>0?(r(),l("div",yt,[t("a",{class:"text-lg text-accent font-bold",href:i.route("posts.show",{post:e.post.id})},"Show "+g(e.post.repliesCount)+" replies...",9,xt)])):u("",!0)]))]))}},Pt={class:"h-screen overflow-hidden flex gap-4 md:p-4"},$t={class:"card card-bordered w-1/5 hidden md:block p-4"},Ct={class:"space-y-3"},St=["href"],zt=["href"],jt=["href"],Bt=["href"],Lt=["href"],Rt=["href"],Ht={class:"w-full md:w-3/5 overflow-y-scroll rounded"},Tt={class:"sticky top-0 z-10 backdrop-blur-xl w-full mb-4"},Nt={class:"navbar flex justify-between shadow-md rounded-b"},Dt={class:"flex gap-3"},Ft=["href"],Ut=["href"],At=x('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-logout" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2"></path><path d="M9 12h12l-3 -3"></path><path d="M18 15l3 -3"></path></svg>',1),Vt=[At],Et={class:"card card-bordered w-1/5 hidden md:block p-4"},Ot=t("h2",{class:"text-xl font-bold text-center mb-3"},"Latest authors",-1),It={class:"space-y-3"},Wt=["href"],qt={class:"w-full fixed bottom-0 md:hidden"},Kt={class:"menu flex justify-between menu-horizontal bg-base-200 rounded-t-box"},Gt=["href"],Jt=x('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M5 12l-2 0l9 -9l9 9l-2 0"></path><path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path><path d="M10 12h4v4h-4z"></path></svg>',1),Qt=[Jt],Xt=["href"],Yt=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-search",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"}),t("path",{d:"M21 21l-6 -6"})],-1),Zt=[Yt],te={key:0},ee=["href"],oe=x('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-square-rounded-plus" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M9 12h6"></path><path d="M12 9v6"></path><path d="M12 3c7.2 0 9 1.8 9 9s-1.8 9 -9 9s-9 -1.8 -9 -9s1.8 -9 9 -9z"></path></svg>',1),se=[oe],ne={key:1},re=["href"],le=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-heart-filled",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M6.979 3.074a6 6 0 0 1 4.988 1.425l.037 .033l.034 -.03a6 6 0 0 1 4.733 -1.44l.246 .036a6 6 0 0 1 3.364 10.008l-.18 .185l-.048 .041l-7.45 7.379a1 1 0 0 1 -1.313 .082l-.094 -.082l-7.493 -7.422a6 6 0 0 1 3.176 -10.215z","stroke-width":"0",fill:"currentColor"})],-1),ae=[le],ie=["href"],ce=x('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user-circle" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M12 10m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path><path d="M6.168 18.849a4 4 0 0 1 3.832 -2.849h4a4 4 0 0 1 3.834 2.855"></path></svg>',1),de=[ce],he={class:"flex items-center justify-between w-full mb-3"},ue={key:0,class:"font-bold text-xl"},pe={key:1,class:"font-bold text-xl"},fe=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-x",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M18 6l-12 12"}),t("path",{d:"M6 6l12 12"})],-1),we=[fe],_e={__name:"DefaultLayout",setup(e){var k,i,d;const c=S(),s=_((d=(i=(k=c.props)==null?void 0:k.auth)==null?void 0:i.user)==null?void 0:d.id);N(()=>{var o,f,w;s.value=(w=(f=(o=c.props)==null?void 0:o.auth)==null?void 0:f.user)==null?void 0:w.id});const n=b(),p=()=>{y.post(route("logout"))};return(o,f)=>(r(),l("div",Pt,[t("aside",$t,[t("nav",null,[t("ul",Ct,[t("li",null,[t("a",{class:h([{"text-primary":o.route().current("home")},"btn btn-outline w-full"]),href:o.route("home")},"Home",10,St)]),s.value?u("",!0):(r(),l(P,{key:0},[t("li",null,[t("a",{class:h([{"text-primary":o.route().current("login")},"btn btn-outline w-full"]),href:o.route("login")}," Login ",10,zt)]),t("li",null,[t("a",{class:h([{"text-primary":o.route().current("register")},"btn btn-outline w-full"]),href:o.route("register")}," Register ",10,jt)])],64)),t("li",null,[t("a",{class:h([{"text-primary":o.route().current("posts.search")},"btn btn-outline w-full"]),href:o.route("posts.search")}," Search ",10,Bt)]),s.value?(r(),l(P,{key:1},[t("li",null,[t("a",{class:h([{"text-primary":o.route().current("profile.edit")},"btn btn-outline w-full"]),href:o.route("profile.edit")},"Profile",10,Lt)]),t("li",null,[t("a",{class:h([{"text-primary":o.route().current("posts.favourites")},"btn btn-outline w-full"]),href:o.route("posts.favourites")},"Favourites",10,Rt)]),t("li",null,[s.value?(r(),l("button",{key:0,onClick:f[0]||(f[0]=(...w)=>a(n).openPostModal&&a(n).openPostModal(...w)),class:"w-full btn btn-primary"},"New post ")):u("",!0)])],64)):u("",!0)])])]),t("main",Ht,[t("header",Tt,[t("nav",Nt,[t("div",Dt,[t("a",{class:h([{"text-primary":o.route().current("home")},"btn btn-ghost normal-case text-xl"]),href:o.route("home")}," Writty ",10,Ft),s.value?(r(),l("a",{key:0,class:h([{"text-primary":o.route().current("posts.following")},"btn btn-ghost normal-case text-xl"]),href:o.route("posts.following")}," Following ",10,Ut)):u("",!0)]),s.value?(r(),l("button",{key:0,onClick:p},Vt)):u("",!0)])]),D(o.$slots,"default")]),t("aside",Et,[Ot,t("ul",It,[(r(!0),l(P,null,F(a(c).props.latestAuthors,w=>(r(),l("li",null,[t("a",{class:"block font-bold w-full rounded px-2 py-1 text-center bg-base-200",href:o.route("profile.show",{user:w})},"@"+g(w),9,Wt)]))),256))])]),t("footer",qt,[t("ul",Kt,[t("li",null,[t("a",{href:o.route("home"),class:h({"text-primary":o.route().current("home")})},Qt,10,Gt)]),t("li",null,[t("a",{class:h({"text-primary":o.route().current("posts.search")}),href:o.route("posts.search")},Zt,10,Xt)]),s.value?(r(),l("li",te,[t("a",{class:h({"text-primary":o.route().current("posts.create")}),href:o.route("posts.create")},se,10,ee)])):u("",!0),s.value?(r(),l("li",ne,[t("a",{class:h({"text-primary":o.route().current("posts.favourites")}),href:o.route("posts.favourites")},ae,10,re)])):u("",!0),t("li",null,[t("a",{class:h({"text-primary":o.route().current("profile.edit")}),href:s.value?o.route("profile.edit"):o.route("login")},de,10,ie)])])]),a(n).showPostModal?(r(),l("div",{key:0,class:"absolute inset-0 bg-neutral-focus bg-opacity-95 z-20 grid place-items-center",onClick:f[3]||(f[3]=(...w)=>a(n).closePostModal&&a(n).closePostModal(...w))},[t("div",{onClick:f[2]||(f[2]=C(()=>{},["stop"])),class:"relative bg-white dark:bg-neutral card card-bordered p-4 w-full rounded md:w-1/2 md:max-w-5xl"},[t("div",he,[a(n).postToReply?(r(),l("h2",ue,"Reply to ")):(r(),l("h2",pe,"Make new post")),t("button",{onClick:f[1]||(f[1]=(...w)=>a(n).closePostModal&&a(n).closePostModal(...w)),class:"btn btn-sm"},we)]),a(n).postToReply?(r(),U(Mt,{key:0,"without-actions":!0,post:a(n).postToReply},null,8,["post"])):u("",!0),A(W,{onPostCreated:a(n).closePostModal},null,8,["onPostCreated"])])])):u("",!0)]))}};export{_e as _,W as a,Mt as b,$ as p,b as u};
