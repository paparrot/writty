import{x as L,y as R,r as y,l as C,T as H,o as i,c,b as t,e as F,v as T,u as r,n as h,t as g,g as u,d as S,p as U,q as A,z as _,K as j,O as x,A as I,F as $,B as N,i as D,C as O,a as V}from"./app-5efd69aa.js";const b=L("posts",()=>{const l=new URL(window.location.href).searchParams,d=Number(l.get("page"))?Number(l.get("page")):1,n=R({data:[]}),s=y(!1),w=y(d),m=y(1),a=y(null),o=v=>{n.data=v},p=v=>{n.data=n.data.map(k=>(k.id===v&&(k.isLiked=!0,k.likesCount+=1),k))},f=v=>{n.data=n.data.map(k=>(k.id===v&&(k.isLiked=!1,k.likesCount-=1),k))},B=()=>{M(null),s.value=!0},M=v=>{a.value=v};return{posts:n,currentPage:w,lastPage:m,showPostModal:s,setPostToReply:M,postToReply:a,openPostModal:B,closePostModal:()=>{a.value&&M(null),s.value=!1},openReplyModal:v=>{M(v),s.value=!0},setPosts:o,setLiked:p,setUnliked:f,setCurrentPage:v=>{w.value=v},setLastPage:v=>{m.value=v}}});const q=(e,l)=>{const d=e.__vccOpts||e;for(const[n,s]of l)d[n]=s;return d},z=e=>(U("data-v-18e56efe"),e=e(),A(),e),E=["onSubmit"],W={class:"mb-2"},K={class:"text-error"},G={class:"my-2 flex gap-3 items-center"},J=["for"],Q=z(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-paperclip",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M15 7l-6.5 6.5a1.5 1.5 0 0 0 3 3l6.5 -6.5a3 3 0 0 0 -6 -6l-6.5 6.5a4.5 4.5 0 0 0 9 9l6.5 -6.5"})],-1)),X=["id"],Y={class:"text-error"},Z={key:0,class:"attachment-container relative w-32"},tt=["src"],et=_('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" data-v-18e56efe><path stroke="none" d="M0 0h24v24H0z" fill="none" data-v-18e56efe></path><path d="M4 7l16 0" data-v-18e56efe></path><path d="M10 11l0 6" data-v-18e56efe></path><path d="M14 11l0 6" data-v-18e56efe></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" data-v-18e56efe></path><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" data-v-18e56efe></path></svg>',1),ot=[et],st=z(()=>t("div",{class:"form-control"},[t("button",{class:"btn btn-sm btn-primary w-full",type:"submit"},"Publish")],-1)),nt={__name:"PostForm",props:{replied:{type:String,default:null}},emits:["post-created"],setup(e,{emit:l}){const{replied:d}=e,n=C({get:()=>s.attachment?URL.createObjectURL(s.attachment):null,set:m=>m}),s=H({content:"",attachment:null});b();const w=async()=>{if(d){s.post(route("posts.reply",{post:d}),{preserveState:!1,onSuccess:()=>{s.reset(),l("post-created")}});return}s.post(route("posts.store"),{onSuccess:()=>{s.reset(),l("post-created")}})};return(m,a)=>(i(),c("form",{class:"py-3",onSubmit:S(w,["prevent"])},[t("div",W,[F(t("textarea",{name:"content",onInput:a[0]||(a[0]=o=>r(s).errors.content=null),"onUpdate:modelValue":a[1]||(a[1]=o=>r(s).content=o),placeholder:"What's happen?",class:h([{"textarea-error":r(s).content.length>255||r(s).errors.content},"textarea textarea-bordered resize-none textarea-sm w-full"])},null,34),[[T,r(s).content]]),t("p",K,g(r(s).errors.content),1),t("p",{class:h(["text-gray-500 text-xs",{"text-red-500":r(s).content.length>255}])},g(r(s).content.length)+" / 255",3),t("div",G,[t("label",{for:`attachment-${e.replied}`,class:h([r(s).errors.attachment,"hover:cursor-pointer my-2"])},[Q,t("input",{id:`attachment-${e.replied}`,class:"hidden",accept:"image/*",type:"file",onInput:a[2]||(a[2]=o=>r(s).attachment=o.target.files[0])},null,40,X)],10,J),t("p",Y,g(r(s).errors.attachment),1)]),n.value?(i(),c("div",Z,[t("img",{src:n.value,class:"attachment-image aspect-square object-cover rounded",alt:"Attachment"},null,8,tt),t("button",{onClick:a[3]||(a[3]=o=>r(s).attachment=null),type:"button",class:"attachment-remove-btn absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},ot)])):u("",!0)]),st],40,E))}},rt=q(nt,[["__scopeId","data-v-18e56efe"]]),P={loadMorePosts(){const e=b();if(e.currentPage>=e.lastPage)return;const l=e.currentPage+1,d=j(),n=new URL(window.location.href),s=n.searchParams;s.set("page",l),n.search=s.toString(),x.get(n.toString(),{},{preserveState:!0,preserveScroll:!0,only:["posts"],onSuccess:({props:w})=>{var o;const m=e.posts.data,a=((o=w.posts)==null?void 0:o.data)??w.replies.data;e.setPosts([...m,...a]),e.setCurrentPage(l),window.history.replaceState({},d.title,n.toString())}})},deletePost(e){x.delete(route("posts.delete",{post:e}))},like(e){const l=b();x.post(route("posts.like",{post:e}),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{l.setLiked(e)}})},unlike(e){const l=b();x.delete(route("posts.unlike",{post:e}),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{l.setUnliked(e)}})},listenDeletingPost(){const e="local",l=b();Echo.channel(`${e}_feed`).listen("PostDeleted",d=>{const n=l.posts.data;l.setPosts(n.filter(s=>s.id!==d.id))})},listenCreatingPost(){const e="local",l=b();Echo.channel(`${e}_feed`).listen("PostCreated",({post:d})=>{l.setPosts([d,...l.posts.data])})}},at={class:"border border-neutral-focus rounded p-3"},lt={class:"card-header mb-3 flex justify-between"},it={class:"author items-center flex gap-5"},ct={key:0,class:"avatar"},dt={class:"w-12 rounded-full"},ht=["href"],ut=["src"],pt={key:1,class:"avatar placeholder"},ft={class:"bg-neutral-focus text-neutral-content w-12 rounded-full"},vt={class:"text-2xl font-bold"},wt={class:"author-text"},mt={class:"font-bold"},gt=["href"],kt={class:"font-mono text-gray-500 text-sm"},bt=["href"],_t={class:"font-mono text-gray-500 text-sm"},yt=_('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 7h16"></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path><path d="M10 12l4 4m0 -4l-4 4"></path></svg>',1),xt=[yt],Mt={class:"break-words text-lg"},$t=["src"],Pt={key:1,class:"actions mt-2 flex items-center gap-2 justify-start"},Ct={class:"likes flex gap-1"},St={key:0,class:"font-bold text-lg"},jt=t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),zt=t("path",{d:"M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572"},null,-1),Bt=[jt,zt],Lt=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-message-circle-2",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M3 20l1.3 -3.9a9 8 0 1 1 3.4 2.9l-4.7 1"})],-1),Rt=[Lt],Ht=["href"],Ft=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-message-circle-2",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M3 20l1.3 -3.9a9 8 0 1 1 3.4 2.9l-4.7 1"})],-1),Tt=[Ft],Ut={key:1},At=["href"],It={__name:"Post",props:{post:{type:Object,default:null},withoutActions:{type:Boolean,default:!1},withoutPreview:{type:Boolean,default:!1}},setup(e){const{withoutActions:l,post:d}=e,n=b(),s=j(),w=C(()=>{var a,o;return((o=(a=s.props.auth)==null?void 0:a.user)==null?void 0:o.nickname)===d.author.nickname&&!l}),m=C(()=>!l&&s.props.auth.user);return(a,o)=>(i(),c("article",at,[t("div",lt,[t("div",it,[e.post.author.avatar?(i(),c("div",ct,[t("div",dt,[t("a",{href:a.route("profile.show",{user:e.post.author.nickname})},[t("img",{src:e.post.author.avatar,alt:"post.author.name"},null,8,ut)],8,ht)])])):(i(),c("div",pt,[t("div",ft,[t("span",vt,g(e.post.author.name),1)])])),t("div",wt,[t("h6",mt,[t("a",{href:a.route("profile.show",{user:e.post.author.nickname})},g(e.post.author.name),9,gt)]),t("p",kt,[t("a",{href:a.route("profile.show",{user:e.post.author.nickname})}," @"+g(e.post.author.nickname),9,bt)]),t("p",_t,g(e.post.created),1)])]),w.value?(i(),c("button",{key:0,onClick:o[0]||(o[0]=p=>r(P).deletePost(e.post.id))},xt)):u("",!0)]),t("p",Mt,g(e.post.content),1),!e.withoutPreview&&e.post.attachment?(i(),c("img",{key:0,class:"object-cover aspect-square my-2 rounded",src:e.post.attachment,alt:"Attachment"},null,8,$t)):u("",!0),m.value?(i(),c("div",Pt,[t("div",Ct,[e.post.likesCount?(i(),c("p",St,g(e.post.likesCount),1)):u("",!0),a.$page.props.auth.user?(i(),c("button",{key:1,onClick:o[1]||(o[1]=p=>e.post.isLiked?r(P).unlike(e.post.id):r(P).like(e.post.id))},[(i(),c("svg",{class:h([{"fill-pink-300 stroke-pink-500":e.post.isLiked},"icon icon-tabler icon-tabler-heart"]),xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},Bt,2))])):u("",!0)]),a.$page.props.auth.user?(i(),c("button",{key:0,class:"hidden md:block",onClick:o[2]||(o[2]=S(p=>r(n).openReplyModal(e.post),["stop"]))},Rt)):u("",!0),t("a",{class:"md:hidden",href:a.route("posts.reply.create",{post:e.post.id})},Tt,8,Ht),e.post.repliesCount>0?(i(),c("div",Ut,[t("a",{class:"text-lg text-accent font-bold",href:a.route("posts.show",{post:e.post.id})},"Show "+g(e.post.repliesCount)+" replies...",9,At)])):u("",!0)])):u("",!0)]))}},Nt={class:"h-screen overflow-hidden max-w-6xl mx-auto flex gap-4 md:p-4"},Dt={class:"card card-bordered border-neutral w-3/12 hidden md:block p-4"},Ot={class:"space-y-3"},Vt=["href"],qt=["href"],Et=["href"],Wt=["href"],Kt=["href"],Gt=["href"],Jt={class:"w-full md:w-6/12 overflow-y-scroll rounded"},Qt={class:"sticky top-0 z-10 backdrop-blur-xl w-full mb-4"},Xt={class:"navbar flex justify-between shadow-md rounded-b"},Yt={class:"flex gap-3"},Zt=["href"],te=["href"],ee=_('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-logout" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2"></path><path d="M9 12h12l-3 -3"></path><path d="M18 15l3 -3"></path></svg>',1),oe=[ee],se={class:"card card-bordered border-neutral w-3/12 hidden md:block p-4"},ne=t("h2",{class:"text-xl font-bold text-center mb-3"},"Latest authors",-1),re={class:"space-y-3"},ae=["href"],le={class:"w-full fixed bottom-0 md:hidden"},ie={class:"menu flex justify-between menu-horizontal bg-base-200 rounded-t-box"},ce=["href"],de=_('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M5 12l-2 0l9 -9l9 9l-2 0"></path><path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path><path d="M10 12h4v4h-4z"></path></svg>',1),he=[de],ue=["href"],pe=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-search",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"}),t("path",{d:"M21 21l-6 -6"})],-1),fe=[pe],ve={key:0},we=["href"],me=_('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-square-rounded-plus" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M9 12h6"></path><path d="M12 9v6"></path><path d="M12 3c7.2 0 9 1.8 9 9s-1.8 9 -9 9s-9 -1.8 -9 -9s1.8 -9 9 -9z"></path></svg>',1),ge=[me],ke={key:1},be=["href"],_e=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-heart-filled",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M6.979 3.074a6 6 0 0 1 4.988 1.425l.037 .033l.034 -.03a6 6 0 0 1 4.733 -1.44l.246 .036a6 6 0 0 1 3.364 10.008l-.18 .185l-.048 .041l-7.45 7.379a1 1 0 0 1 -1.313 .082l-.094 -.082l-7.493 -7.422a6 6 0 0 1 3.176 -10.215z","stroke-width":"0",fill:"currentColor"})],-1),ye=[_e],xe=["href"],Me=_('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user-circle" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"></path><path d="M12 10m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0"></path><path d="M6.168 18.849a4 4 0 0 1 3.832 -2.849h4a4 4 0 0 1 3.834 2.855"></path></svg>',1),$e=[Me],Pe={class:"flex items-center justify-between w-full mb-3"},Ce={key:0,class:"font-bold text-xl"},Se={key:1,class:"font-bold text-xl"},je=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon icon-tabler icon-tabler-x",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),t("path",{d:"M18 6l-12 12"}),t("path",{d:"M6 6l12 12"})],-1),ze=[je],Te={__name:"DefaultLayout",setup(e){var w,m,a;const l=j(),d=y((a=(m=(w=l.props)==null?void 0:w.auth)==null?void 0:m.user)==null?void 0:a.id);I(()=>{var o,p,f;d.value=(f=(p=(o=l.props)==null?void 0:o.auth)==null?void 0:p.user)==null?void 0:f.id});const n=b(),s=()=>{x.post(route("logout"))};return(o,p)=>(i(),c("div",Nt,[t("aside",Dt,[t("nav",null,[t("ul",Ot,[t("li",null,[t("a",{class:h([{"text-primary":o.route().current("home")},"btn btn-outline w-full"]),href:o.route("home")},"Home",10,Vt)]),d.value?u("",!0):(i(),c($,{key:0},[t("li",null,[t("a",{class:h([{"text-primary":o.route().current("login")},"btn btn-outline w-full"]),href:o.route("login")}," Login ",10,qt)]),t("li",null,[t("a",{class:h([{"text-primary":o.route().current("register")},"btn btn-outline w-full"]),href:o.route("register")}," Register ",10,Et)])],64)),t("li",null,[t("a",{class:h([{"text-primary":o.route().current("posts.search")},"btn btn-outline w-full"]),href:o.route("posts.search")}," Search ",10,Wt)]),d.value?(i(),c($,{key:1},[t("li",null,[t("a",{class:h([{"text-primary":o.route().current("profile.edit")},"btn btn-outline w-full"]),href:o.route("profile.edit")},"Profile",10,Kt)]),t("li",null,[t("a",{class:h([{"text-primary":o.route().current("posts.favourites")},"btn btn-outline w-full"]),href:o.route("posts.favourites")},"Favourites",10,Gt)]),t("li",null,[d.value?(i(),c("button",{key:0,onClick:p[0]||(p[0]=(...f)=>r(n).openPostModal&&r(n).openPostModal(...f)),class:"w-full btn btn-primary"},"New post ")):u("",!0)])],64)):u("",!0)])])]),t("main",Jt,[t("header",Qt,[t("nav",Xt,[t("div",Yt,[t("a",{class:h([{"text-primary":o.route().current("home")},"btn btn-ghost normal-case text-xl"]),href:o.route("home")}," Writty ",10,Zt),d.value?(i(),c("a",{key:0,class:h([{"text-primary":o.route().current("posts.following")},"btn btn-ghost normal-case text-xl"]),href:o.route("posts.following")}," Following ",10,te)):u("",!0)]),d.value?(i(),c("button",{key:0,onClick:s},oe)):u("",!0)])]),N(o.$slots,"default")]),t("aside",se,[ne,t("ul",re,[(i(!0),c($,null,D(r(l).props.latestAuthors,f=>(i(),c("li",null,[t("a",{class:"block font-bold w-full rounded px-2 py-1 text-center bg-base-200",href:o.route("profile.show",{user:f})},"@"+g(f),9,ae)]))),256))])]),t("footer",le,[t("ul",ie,[t("li",null,[t("a",{href:o.route("home"),class:h({"text-primary":o.route().current("home")})},he,10,ce)]),t("li",null,[t("a",{class:h({"text-primary":o.route().current("posts.search")}),href:o.route("posts.search")},fe,10,ue)]),d.value?(i(),c("li",ve,[t("a",{class:h({"text-primary":o.route().current("posts.create")}),href:o.route("posts.create")},ge,10,we)])):u("",!0),d.value?(i(),c("li",ke,[t("a",{class:h({"text-primary":o.route().current("posts.favourites")}),href:o.route("posts.favourites")},ye,10,be)])):u("",!0),t("li",null,[t("a",{class:h({"text-primary":o.route().current("profile.edit")}),href:d.value?o.route("profile.edit"):o.route("login")},$e,10,xe)])])]),r(n).showPostModal?(i(),c("div",{key:0,class:"absolute inset-0 bg-neutral-focus bg-opacity-95 z-20 grid place-items-center",onClick:p[3]||(p[3]=(...f)=>r(n).closePostModal&&r(n).closePostModal(...f))},[t("div",{onClick:p[2]||(p[2]=S(()=>{},["stop"])),class:"relative bg-white dark:bg-neutral card card-bordered p-4 w-full rounded md:w-1/2 md:max-w-5xl"},[t("div",Pe,[r(n).postToReply?(i(),c("h2",Ce,"Reply to ")):(i(),c("h2",Se,"Make new post")),t("button",{onClick:p[1]||(p[1]=(...f)=>r(n).closePostModal&&r(n).closePostModal(...f)),class:"btn btn-sm"},ze)]),r(n).postToReply?(i(),O(It,{key:0,"without-preview":"","without-actions":"",post:r(n).postToReply},null,8,["post"])):u("",!0),V(rt,{replied:r(n).postToReply,onPostCreated:r(n).closePostModal},null,8,["replied","onPostCreated"])])])):u("",!0)]))}};export{rt as P,Te as _,q as a,It as b,P as p,b as u};
