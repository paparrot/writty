import{q as f,r as p,K as m,O as g,o as i,c as l,F as v,i as P,b as o,t as h,g as w,s as k}from"./app-beabed82.js";const _=f("posts",()=>{const s=new URL(window.location.href).searchParams,r=Number(s.get("page"))?Number(s.get("page")):1,a=p([]),n=p(r),c=p(1);return{posts:a,currentPage:n,lastPage:c,setPosts:d=>{a.value=d},setCurrentPage:d=>{n.value=d},setLastPage:d=>{c.value=d}}}),x={loadMorePosts(){const e=_();if(e.currentPage>=e.lastPage)return;const s=e.currentPage+1,r=m(),a=new URL(window.location.href),n=a.searchParams;n.set("page",s),a.search=n.toString(),g.get(a.toString(),{},{preserveState:!0,preserveScroll:!0,only:["posts"],onSuccess:({props:c})=>{const t=e.posts,u=c.posts.data;e.setPosts([...t,...u]),e.setCurrentPage(s),window.history.replaceState({},r.title,a.toString())}})},deletePost(e){g.delete(route("posts.delete",{post:e}))},listenDeletingPost(){const e=_();Echo.channel("feed").listen("PostDeleted",s=>{const r=e.posts;e.setPosts(r.filter(a=>a.id!==s.id))})},listenCreatingPost(){const e=_();Echo.channel("feed").listen("PostCreated",s=>{e.setPosts([s,...e.posts])})}},b=(e,s)=>{const r=e.__vccOpts||e;for(const[a,n]of s)r[a]=n;return r},S={computed:{postService(){return x}},props:{posts:{type:Array}},mounted(){new IntersectionObserver(s=>s.forEach(r=>r.isIntersecting&&this.$emit("load-more-posts"),{rootMargin:"-150px 0px 0px 0px"})).observe(this.$refs.loadMoreIntersect)}},y={class:"space-y-2 px-3"},C={class:"card-header mb-3 flex justify-between"},M={class:"author items-center flex gap-5"},$={key:0,class:"avatar"},L={class:"w-12 rounded-full"},N=["src"],B={key:1,class:"avatar placeholder"},E={class:"bg-neutral-focus text-neutral-content w-12 rounded-full"},I={class:"text-2xl font-bold"},O={class:"author-text"},D={class:"font-bold"},V=["href"],j={class:"font-mono text-gray-500 text-sm"},F=["href"],R={class:"font-mono text-gray-500 text-sm"},U=["onClick"],q=k('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 7h16"></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path><path d="M10 12l4 4m0 -4l-4 4"></path></svg>',1),z=[q],A={class:"break-words text-lg"},H={ref:"loadMoreIntersect"};function K(e,s,r,a,n,c){return i(),l("div",y,[(i(!0),l(v,null,P(r.posts,t=>(i(),l("article",{key:t,class:"card border rounded p-3"},[o("div",C,[o("div",M,[t.author.avatar?(i(),l("div",$,[o("div",L,[o("img",{src:t.author.avatar,alt:"post.author.name"},null,8,N)])])):(i(),l("div",B,[o("div",E,[o("span",I,h(t.author.name),1)])])),o("div",O,[o("h6",D,[o("a",{href:e.route("profile.show",{user:t.author.nickname})},h(t.author.name),9,V)]),o("p",j,[o("a",{href:e.route("profile.show",{user:t.author.nickname})}," @"+h(t.author.nickname),9,F)]),o("p",R,h(t.created),1)])]),e.$page.props.auth.user&&e.$page.props.auth.user.nickname&&e.$page.props.auth.user.nickname===t.author.nickname?(i(),l("button",{key:0,onClick:u=>c.postService.deletePost(t.id)},z,8,U)):w("",!0)]),o("p",A,h(t.content),1)]))),128)),o("span",H,null,512)])}const Q=b(S,[["render",K]]);export{Q as P,x as p,_ as u};
