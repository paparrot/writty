import{q as k,r as g,K as f,O as v,o as d,c as u,F as m,i as P,b as o,t as h,g as w,n as S,s as x}from"./app-f1fa24f4.js";const p=k("posts",()=>{const s=new URL(window.location.href).searchParams,n=Number(s.get("page"))?Number(s.get("page")):1,r=g([]),c=g(n),i=g(1);return{posts:r,currentPage:c,lastPage:i,setPosts:a=>{r.value=a},setLiked:a=>{r.value=r.value.map(l=>(l.id===a&&(l.isLiked=!0),l))},setUnliked:a=>{r.value=r.value.map(l=>(l.id===a&&(l.isLiked=!1),l))},setCurrentPage:a=>{c.value=a},setLastPage:a=>{i.value=a}}}),b={loadMorePosts(){const e=p();if(e.currentPage>=e.lastPage)return;const s=e.currentPage+1,n=f(),r=new URL(window.location.href),c=r.searchParams;c.set("page",s),r.search=c.toString(),v.get(r.toString(),{},{preserveState:!0,preserveScroll:!0,only:["posts"],onSuccess:({props:i})=>{const t=e.posts,_=i.posts.data;e.setPosts([...t,..._]),e.setCurrentPage(s),window.history.replaceState({},n.title,r.toString())}})},deletePost(e){v.delete(route("posts.delete",{post:e}))},like(e){const s=p();v.post(route("posts.like",{post:e}),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{s.setLiked(e)}})},unlike(e){const s=p();v.delete(route("posts.unlike",{post:e}),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{console.log(2342),s.setUnliked(e)}})},listenDeletingPost(){const e=p();Echo.channel("feed").listen("PostDeleted",s=>{const n=e.posts;e.setPosts(n.filter(r=>r.id!==s.id))})},listenCreatingPost(){const e=p();Echo.channel("feed").listen("PostCreated",s=>{e.setPosts([s,...e.posts])})}},y=(e,s)=>{const n=e.__vccOpts||e;for(const[r,c]of s)n[r]=c;return n},C={computed:{postService(){return b}},props:{posts:{type:Array}},mounted(){new IntersectionObserver(s=>s.forEach(n=>n.isIntersecting&&this.$emit("load-more-posts"),{rootMargin:"-150px 0px 0px 0px"})).observe(this.$refs.loadMoreIntersect)}},L={class:"space-y-2 px-3"},M={class:"card-header mb-3 flex justify-between"},$={class:"author items-center flex gap-5"},B={key:0,class:"avatar"},N={class:"w-12 rounded-full"},U=["src"],j={key:1,class:"avatar placeholder"},E={class:"bg-neutral-focus text-neutral-content w-12 rounded-full"},I={class:"text-2xl font-bold"},O={class:"author-text"},z={class:"font-bold"},D=["href"],V={class:"font-mono text-gray-500 text-sm"},F=["href"],H={class:"font-mono text-gray-500 text-sm"},R=["onClick"],q=x('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 7h16"></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path><path d="M10 12l4 4m0 -4l-4 4"></path></svg>',1),A=[q],K={class:"break-words text-lg"},G={class:"actions flex gap-2 justify-end"},J=["onClick"],Q=o("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),T=o("path",{d:"M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572"},null,-1),W=[Q,T],X={ref:"loadMoreIntersect"};function Y(e,s,n,r,c,i){return d(),u("div",L,[(d(!0),u(m,null,P(n.posts,t=>(d(),u("article",{key:t,class:"card border rounded p-3"},[o("div",M,[o("div",$,[t.author.avatar?(d(),u("div",B,[o("div",N,[o("img",{src:t.author.avatar,alt:"post.author.name"},null,8,U)])])):(d(),u("div",j,[o("div",E,[o("span",I,h(t.author.name),1)])])),o("div",O,[o("h6",z,[o("a",{href:e.route("profile.show",{user:t.author.nickname})},h(t.author.name),9,D)]),o("p",V,[o("a",{href:e.route("profile.show",{user:t.author.nickname})}," @"+h(t.author.nickname),9,F)]),o("p",H,h(t.created),1)])]),e.$page.props.auth.user&&e.$page.props.auth.user.nickname&&e.$page.props.auth.user.nickname===t.author.nickname?(d(),u("button",{key:0,onClick:_=>i.postService.deletePost(t.id)},A,8,R)):w("",!0)]),o("p",K,h(t.content),1),o("div",G,[o("button",{onClick:_=>t.isLiked?i.postService.unlike(t.id):i.postService.like(t.id)},[(d(),u("svg",{class:S([{"fill-pink-300 stroke-pink-500":t.isLiked},"icon icon-tabler icon-tabler-heart"]),xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},W,2))],8,J)])]))),128)),o("span",X,null,512)])}const oe=y(C,[["render",Y]]);export{oe as P,b as p,p as u};
