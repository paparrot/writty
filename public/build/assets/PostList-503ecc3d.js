import{y as f,z as m,r as k,K as P,O as g,o as l,c as d,F as w,i as S,b as o,t as h,g as v,n as b,A as x}from"./app-d2374df9.js";const p=f("posts",()=>{const s=new URL(window.location.href).searchParams,a=Number(s.get("page"))?Number(s.get("page")):1,r=m({data:[]}),c=k(a),i=k(1);return{posts:r,currentPage:c,lastPage:i,setPosts:n=>{r.data=n},setLiked:n=>{r.data=r.data.map(u=>(u.id===n&&(u.isLiked=!0),u))},setUnliked:n=>{r.data=r.data.map(u=>(u.id===n&&(u.isLiked=!1),u))},setCurrentPage:n=>{c.value=n},setLastPage:n=>{i.value=n}}}),y={loadMorePosts(){const e=p();if(e.currentPage>=e.lastPage)return;const s=e.currentPage+1,a=P(),r=new URL(window.location.href),c=r.searchParams;c.set("page",s),r.search=c.toString(),g.get(r.toString(),{},{preserveState:!0,preserveScroll:!0,only:["posts"],onSuccess:({props:i})=>{const t=e.posts,_=i.posts.data;e.setPosts([...t,..._]),e.setCurrentPage(s),window.history.replaceState({},a.title,r.toString())}})},deletePost(e){g.delete(route("posts.delete",{post:e}))},like(e){const s=p();g.post(route("posts.like",{post:e}),{},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{s.setLiked(e)}})},unlike(e){const s=p();g.delete(route("posts.unlike",{post:e}),{preserveState:!0,preserveScroll:!0,onSuccess:()=>{console.log(2342),s.setUnliked(e)}})},listenDeletingPost(){const e=p();Echo.channel("feed").listen("PostDeleted",s=>{const a=e.posts.data;e.setPosts(a.filter(r=>r.id!==s.id))})},listenCreatingPost(){const e=p();Echo.channel("feed").listen("PostCreated",({post:s})=>{e.setPosts([s,...e.posts.data])})}},C=(e,s)=>{const a=e.__vccOpts||e;for(const[r,c]of s)a[r]=c;return a},L={computed:{postService(){return y}},props:{posts:{type:Array}},mounted(){new IntersectionObserver(s=>s.forEach(a=>a.isIntersecting&&this.$emit("load-more-posts"),{rootMargin:"-150px 0px 0px 0px"})).observe(this.$refs.loadMoreIntersect)}},M={class:"space-y-2 px-3"},$={class:"card-header mb-3 flex justify-between"},B={class:"author items-center flex gap-5"},N={key:0,class:"avatar"},U={class:"w-12 rounded-full"},j=["src"],z={key:1,class:"avatar placeholder"},E={class:"bg-neutral-focus text-neutral-content w-12 rounded-full"},I={class:"text-2xl font-bold"},O={class:"author-text"},D={class:"font-bold"},V=["href"],A={class:"font-mono text-gray-500 text-sm"},F=["href"],H={class:"font-mono text-gray-500 text-sm"},R=["onClick"],K=x('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-trash-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 7h16"></path><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path><path d="M10 12l4 4m0 -4l-4 4"></path></svg>',1),q=[K],G={class:"break-words text-lg"},J={class:"actions flex gap-2 justify-end"},Q=["onClick"],T=o("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"},null,-1),W=o("path",{d:"M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572"},null,-1),X=[T,W],Y={ref:"loadMoreIntersect"};function Z(e,s,a,r,c,i){return l(),d("div",M,[(l(!0),d(w,null,S(a.posts,t=>(l(),d("article",{key:t,class:"border border-neutral-focus rounded p-3"},[o("div",$,[o("div",B,[t.author.avatar?(l(),d("div",N,[o("div",U,[o("img",{src:t.author.avatar,alt:"post.author.name"},null,8,j)])])):(l(),d("div",z,[o("div",E,[o("span",I,h(t.author.name),1)])])),o("div",O,[o("h6",D,[o("a",{href:e.route("profile.show",{user:t.author.nickname})},h(t.author.name),9,V)]),o("p",A,[o("a",{href:e.route("profile.show",{user:t.author.nickname})}," @"+h(t.author.nickname),9,F)]),o("p",H,h(t.created),1)])]),e.$page.props.auth.user&&e.$page.props.auth.user.nickname&&e.$page.props.auth.user.nickname===t.author.nickname?(l(),d("button",{key:0,onClick:_=>i.postService.deletePost(t.id)},q,8,R)):v("",!0)]),o("p",G,h(t.content),1),o("div",J,[e.$page.props.auth.user?(l(),d("button",{key:0,onClick:_=>t.isLiked?i.postService.unlike(t.id):i.postService.like(t.id)},[(l(),d("svg",{class:b([{"fill-pink-300 stroke-pink-500":t.isLiked},"icon icon-tabler icon-tabler-heart"]),xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},X,2))],8,Q)):v("",!0)])]))),128)),o("span",Y,null,512)])}const re=C(L,[["render",Z]]);export{re as P,C as _,y as p,p as u};
